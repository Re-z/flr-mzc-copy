(function($){const version="0.5.1";$.fn.ivideo=function(options){var _init=(options)=>{if(options==undefined)return this;var globalDefaults={debug:false,html5url:"",locale:"en",loop:false,autoplay:false,player:null,width:"100%",height:"100%",controls:true,mute:false,overlay:true,ids:null,subtitles:false};var globalSettings=$.extend({},globalDefaults,options);$(this).each((i,el)=>{var $el=$(el);$el.ivideo=this;var defaults={_parsedIds:[],_player:null,_system:null,_parsedId:null,_random:Math.random().toString(36).substr(2)};var settings=$.extend({},globalSettings,defaults);settings.el=el;if($el.data("debug"))settings.debug=$el.data("debug");$el.removeAttr('data-debug');if($el.data("locale"))settings.locale=$el.data("locale");$el.removeAttr('data-locale');if($el.data("ids"))settings.ids=$el.data("ids");$el.removeAttr('data-ids');el.ivideo_settings=settings;if(settings.debug)console.debug('[ivideo](debug): Init!');$el.append($('<div class="component-ivideo" id="'+settings._random+'-ivideo"><div class="videoWrapper"></div></div>'));if(settings.ids!==null){settings.ids.split(",").forEach(function(s){var arr=s.split(":")
settings._parsedIds.push({system:arr[0],id:arr[1],attempt:false})});}
if(settings.debug)console.debug('[ivideo](debug) '+version+' Component:',{"el":el,"ivideo":this,});});_loadOverlay();_loadVideo();return this;}
var _loadOverlay=()=>{$(this).each((i,el)=>{var settings=this.getSettings(i);if(settings.overlay){var overlay=$('<div class="videoOverlayInner">'+
'<div class="videoOverlayHeadline">'+settings.translations['overlay_text']+'</div>'+
'<a href="#overlay" id="videoOverlayPlay">'+
'<img src="images/play_btn.png" alt="">'+
'</a>'+
'</div>');$('a',overlay).click((e)=>{e.preventDefault();overlay.hide();this.play(settings);});$('.component-ivideo',settings.el).append(overlay);}});return this;}
var _loadVideo=()=>{$(this).each((i,el)=>{var settings=this.getSettings(i);var v=settings._parsedIds[0];if(settings.debug)console.debug("[ivideo](debug): Load video: "+v.system+": "+v.id);if(v.attempt==false){settings._parsedId=v.id;settings._system=v.system;if(v.system=="youtube"){window.onYouTubeIframeAPIReady=()=>{$('.videoWrapper',settings.el).append($('<div id="'+settings._random+'-youtube"></div>'));settings._player=new YT.Player(settings._random+'-youtube',{height:settings.height,width:settings.width,videoId:v.id,playerVars:{mute:settings.mute,controls:settings.controls,rel:0,showinfo:0},events:{'onStateChange':(e)=>{if(e.data==YT.PlayerState.ENDED){if(settings.debug)console.debug("[ivideo](debug): Event: end");$(this).trigger({type:'end'});}
if(e.data==YT.PlayerState.PLAYING){if(settings.debug)console.debug("[ivideo](debug): Event: start");$(this).trigger({type:'start'});}},'onReady':(e)=>{if(settings.debug)console.debug("[ivideo](debug): Event: loaded");$(this).trigger({type:'loaded'});}}});}
if(typeof YT=="undefined"){$.getScript('http://www.youtube.com/iframe_api');}else window.onYouTubeIframeAPIReady();}
if(v.system=="vimeo"){if(typeof Vimeo=="undefined"){$.getScript('https://player.vimeo.com/api/player.js',()=>{settings._player=new Vimeo.Player($('.videoWrapper',settings.el),{url:"https://player.vimeo.com/video/"+v.id,autoplay:settings.autoplay,muted:settings.mute});if(settings.subtitles!==false){var lang=settings.locale;if(lang=="pt-br")lang="pt-BR";if(lang=="es-la")lang="es-419";settings._player.enableTextTrack((settings.subtitles===true?lang:settings.subtitles));}
settings._player.on('ended',(e)=>{if(settings.debug)console.debug("[ivideo](debug): Event: end");$(this).trigger({type:'end'});});settings._player.on('play',(e)=>{if(settings.debug)console.debug("[ivideo](debug): Event: start");$(this).trigger({type:'start'});});settings._player.on('loaded',(e)=>{if(settings.debug)console.debug("[ivideo](debug): Event: loaded");$(this).trigger({type:'loaded'});});});}}
if(v.system=="html5"){var player=$('<video playsinline controls preload="auto" src="'+settings.html5url+'/'+v.id+'"></video>');settings._player=player[0];$('.videoWrapper',settings.el).append(player);player.bind('play',()=>{if(settings.debug)console.debug("[ivideo](debug): Event: play");$(this).trigger({type:'start'});});player.bind('loadeddata',()=>{if(settings.debug)console.debug("[ivideo](debug): Event: loaded");$(this).trigger({type:'loaded'});});player.bind('ended',()=>{if(settings.debug)console.debug("[ivideo](debug): Event: end");$(this).trigger({type:'end'});});}
if(v.system=="vjs"){throw Error("vjs not implemented.");}}});}
this.play=(settings)=>{if(settings==undefined){$(this).each((i,el)=>{var settings=this.getSettings(i);return this.play(settings);});}else{if(settings._system=="html5"){settings._player.play();}
if(settings._system=="vimeo"){settings._player.play();}
if(settings._system=="youtube"){settings._player.playVideo();}}
return this;}
this.stop=(settings)=>{if(settings==undefined){$(this).each((i,el)=>{var settings=this.getSettings(i);return this.stop(settings);});}else{if(settings._system=="html5"){settings._player.pause();settings._player.currentTime=0;}
if(settings._system=="vimeo"){settings._player.pause();settings._player.setCurrentTime(0);}
if(settings._system=="youtube"){settings._player.stopVideo();}}
return this;}
this.getSettings=(i)=>{return this[i].ivideo_settings;}
return _init(options);}}(jQuery));